const superagent = require('superagent')

const { error } = require('../util/logger')

module.exports = ({ api, formatUrl, callback }, word, test) => {
  return new Promise(resolve => {
    const formattedUrl = formatUrl(api, word, test)

    superagent
      .get(formattedUrl)
      .end((err, res) => {
        if (err) {
          error(err.message)
        } else {
          const msgArr = callback(JSON.parse(res.text))

          resolve(msgArr)
        }
      })
  })
}
